<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chi tiết sản phẩm - Creamy Tea</title>
    <link rel="stylesheet" href="Styles/trasuakemdau.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>
<body>
<div class="tong">
    <!-- Thêm icon giỏ hàng vào đây -->
    <div class="notification-modal" id="notification-modal">
        <div class="modal-content">
            <div class="modal-icon">
                <i class="fas fa-shopping-cart"></i>
            </div>
            <div class="modal-text">Giỏ hàng của bạn đang trống!</div>
            <button class="modal-close">Đóng</button>
        </div>
    </div>
    <div class="cart-icon">
        <i class="fas fa-shopping-cart"></i>
        <span class="cart-count">0</span>
    </div>

    <div class="header">
        <div class="tren">
            <div class="iconcha">
                <div class="icon">☰</div>
            </div>
            <div class="menu">
                <nav>
                    <a href="index.html">Trang Chủ</a>
                    <a href="index2.html">Về Chúng Tôi</a>
                    <a href="menu.html">Menu</a>
                    <a href="tintuc.html">Tin Tức</a>
                    <a href="#">Liên hệ</a>
                </nav>
            </div>
        </div>
    </div>

    <div class="menu-container" style="background-color: #FFF8E7;">
        <div class="menu-header">
            <h1>Sản Phẩm</h1>
            <p><a href="index.html">Trang Chủ</a>><a href="menu.html">Sản Phẩm</a>><a href="milk-tea.html">Trà Sữa</a></p>
        </div>

        <div class="product-container">
            <div class="product-image">
                <img src="images/tra trai cay/hong tra chanh.jpg" alt="Sản phẩm">
            </div>
            <div class="product-details">
                <h1 class="product-title">HỒNG TRÀ CHANH</h1>
                <div class="product-price">39,000đ</div>
                <p class="topping-note">Chưa có topping</p>
                
                <div class="topping-section">
                    <h3>Chọn Topping</h3>
                    <div class="topping-options">
                        <button class="topping-btn">Không</button>
                        <button class="topping-btn">Đậu đỏ</button>
                        <button class="topping-btn">Pudding</button>
                        <button class="topping-btn">Thạch dừa</button>
                        <button class="topping-btn">Thạch đen</button>
                        <button class="topping-btn">Trân châu trắng</button>
                        <button class="topping-btn">Trân châu hoàng kim</button>
                        <button class="topping-btn">Kem cheese</button>
                        <button class="topping-btn">Foam trứng</button>
                        <button class="topping-btn">Trân châu đường đen</button>
                    </div>
                </div>

                <div class="quantity-section">
                    <h3>Chọn số lượng</h3>
                    <div class="quantity-control">
                        <button class="quantity-btn minus">-</button>
                        <input type="number" value="1" min="1" class="quantity-input">
                        <button class="quantity-btn plus">+</button>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="add-to-cart">Thêm vào giỏ</button>
                    <button class="buy-now">Xem giỏ hàng</button>
                </div>
            </div>
        </div>
    </div>

    <div class="bottom">
        <div class="bottom-content">
            <div class="logo">
                <img src="Logo/logo.jpg" alt="Creamy Tea Logo">
            </div>
            <div class="info-container">
                <div class="copyright">
                    © CREAMY TEA . made by fresh cream
                </div>
                <div class="contact-info">
                    <p class="address">Địa chỉ: 935/7/43C Bình giã / Vũng Tàu</p>
                    <p class="email">Email: tranhuyhoang159753@gmail.com</p>
                </div>
            </div>
            <div class="social-icons">
                <a href="https://www.facebook.com/profile.php?id=100065041573512&locale=vi_VN">
                    <img src="images/facebook logos vector (AI, EPS, SVG, PDF, CDR) free download_preview_rev_1.png" alt="Facebook">
                </a>
                <a href="https://www.tiktok.com/@hoangtran.chm?lang=vi-VN">
                    <img src="images/Tik Tok Icon Circle PNG Transparent With Clear Background ID 473286 _ TopPNG_preview_rev_1.png" alt="TikTok">
                </a>
            </div>
        </div>
    </div>
</div>

<script>
    // Menu toggle
    document.querySelector('.icon').addEventListener('click', function() {
        document.querySelector('.menu').classList.toggle('active');
        this.classList.toggle('active');
        this.innerHTML = this.classList.contains('active') ? '✖' : '☰';
    });

    // Quantity control
    const quantityInput = document.querySelector('.quantity-input');
    let currentQuantity = 1;

    document.querySelector('.minus').addEventListener('click', () => {
        if (currentQuantity > 1) {
            currentQuantity--;
            quantityInput.value = currentQuantity;
        }
    });

    document.querySelector('.plus').addEventListener('click', () => {
        currentQuantity++;
        quantityInput.value = currentQuantity;
    });

    // Cập nhật khi người dùng nhập trực tiếp
    quantityInput.addEventListener('change', (e) => {
        let value = parseInt(e.target.value);
        if (value < 1) value = 1;
        currentQuantity = value;
        quantityInput.value = currentQuantity;
    });

    // Topping selection
    const toppingBtns = document.querySelectorAll('.topping-btn');
    toppingBtns.forEach(btn => {
        btn.addEventListener('click', () => {
            btn.classList.toggle('active');
        });
    });

    // Khởi tạo giỏ hàng từ localStorage hoặc tạo mới
    let cart = JSON.parse(localStorage.getItem('cart')) || [];

    // Cập nhật số lượng hiển thị trên icon giỏ hàng
    function updateCartIcon() {
        const cartCount = document.querySelector('.cart-count');
        const totalItems = cart.reduce((total, item) => total + item.quantity, 0);
        cartCount.textContent = totalItems;
    }

    // Xử lý thêm vào giỏ hàng
    document.querySelector('.add-to-cart').addEventListener('click', function(e) {
        // Lấy thông tin sản phẩm
        const product = {
            name: document.querySelector('.product-title').textContent,
            price: document.querySelector('.product-price').textContent,
            image: document.querySelector('.product-image img').src,
            quantity: currentQuantity,
            toppings: Array.from(document.querySelectorAll('.topping-btn.active'))
                         .map(btn => btn.textContent)
        };

        // Kiểm tra sản phẩm đã có trong giỏ hàng chưa
        const existingProductIndex = cart.findIndex(item => 
            item.name === product.name && 
            JSON.stringify(item.toppings) === JSON.stringify(product.toppings)
        );

        if (existingProductIndex !== -1) {
            cart[existingProductIndex].quantity += currentQuantity;
        } else {
            cart.push(product);
        }

        // Lưu giỏ hàng vào localStorage
        localStorage.setItem('cart', JSON.stringify(cart));

        // Tạo hiệu ứng bay vào giỏ
        for(let i = 0; i < currentQuantity; i++) {
            setTimeout(() => {
                const flyingDot = document.createElement('div');
                flyingDot.className = 'flying-item';
                
                const buttonRect = this.getBoundingClientRect();
                flyingDot.style.left = buttonRect.left + 'px';
                flyingDot.style.top = buttonRect.top + 'px';
                
                document.body.appendChild(flyingDot);
                
                const cart = document.querySelector('.cart-icon');
                const cartRect = cart.getBoundingClientRect();
                
                setTimeout(() => {
                    flyingDot.style.left = cartRect.left + 'px';
                    flyingDot.style.top = cartRect.top + 'px';
                    flyingDot.style.opacity = '0';
                    flyingDot.style.transform = 'scale(0.3)';
                    
                    setTimeout(() => {
                        updateCartIcon();
                        document.body.removeChild(flyingDot);
                    }, 800);
                }, 0);
            }, i * 200);
        }
    });

    // Cập nhật số lượng ban đầu
    updateCartIcon();

    // Chuyển đến trang giỏ hàng khi click vào icon hoặc nút xem giỏ hàng
    // Hiển thị modal thông báo
    function showNotification() {
        const modal = document.getElementById('notification-modal');
        modal.style.display = 'flex';
    }
    
    // Đóng modal khi click nút đóng
    document.querySelector('.modal-close').addEventListener('click', () => {
        document.getElementById('notification-modal').style.display = 'none';
    });
    
    // Đóng modal khi click bên ngoài
    document.getElementById('notification-modal').addEventListener('click', (e) => {
        if (e.target === document.getElementById('notification-modal')) {
            document.getElementById('notification-modal').style.display = 'none';
        }
    });
    
    // Sửa lại event listener cho cart icon và nút xem giỏ hàng
    document.querySelector('.cart-icon').addEventListener('click', () => {
        const cartCount = document.querySelector('.cart-count');
        if (parseInt(cartCount.textContent) === 0) {
            showNotification();
            return;
        }
        window.location.href = 'cart.html';
    });
    
    document.querySelector('.buy-now').addEventListener('click', () => {
        const cartCount = document.querySelector('.cart-count');
        if (parseInt(cartCount.textContent) === 0) {
            showNotification();
            return;
        }
        window.location.href = 'cart.html';
    });
    
</script>
</body>
</html>
